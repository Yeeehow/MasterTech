<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="MasterTechParallelMAUI.Views.AI.AiPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:conv="clr-namespace:MasterTechParallelMAUI.Converters"
    Shell.NavBarIsVisible="False"
    BackgroundColor="#F5F5F5">

    <Grid RowDefinitions="60,*,Auto,Auto">

        <!-- Header -->
        <Grid BackgroundColor="#D32F2F" Grid.Row="0">
            <Label Text="Coles AI Assistant"
                   FontSize="22"
                   FontAttributes="Bold"
                   TextColor="White"
                   HorizontalOptions="Center"
                   VerticalOptions="Center" />
        </Grid>

        <!-- Messages -->
        <CollectionView x:Name="MessagesView"
                        Grid.Row="1"
                        ItemsSource="{Binding Messages}"
                        BackgroundColor="White"
                        Margin="0,4"
                        SelectionMode="None">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Grid Padding="8">
                        <Border
                            StrokeThickness="0"
                            Padding="10"
                            MaximumWidthRequest="320"
                            HorizontalOptions="{Binding IsUser, Converter={x:Static conv:BoolToLayoutOptionsConverter.Instance}}"
                            BackgroundColor="{Binding IsUser, Converter={x:Static conv:BoolToColorConverter2.Instance}}"
                            StrokeShape="RoundRectangle 12">
                            <Label Text="{Binding Message}"
                                   TextColor="{Binding IsUser, Converter={x:Static conv:BoolToTextColorConverter.Instance}}" />
                        </Border>
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!-- Suggested questions -->
        <ScrollView Grid.Row="2" Orientation="Horizontal" Padding="10,4">
            <HorizontalStackLayout Spacing="8">
                <Button Text="Where can I find dairy products?"
                        Clicked="OnSuggestedQuestionClicked"
                        BackgroundColor="#EEEEEE" TextColor="#000" CornerRadius="20" />
                <Button Text="Whatâ€™s on special this week?"
                        Clicked="OnSuggestedQuestionClicked"
                        BackgroundColor="#EEEEEE" TextColor="#000" CornerRadius="20" />
                <Button Text="Do you have gluten-free bread?"
                        Clicked="OnSuggestedQuestionClicked"
                        BackgroundColor="#EEEEEE" TextColor="#000" CornerRadius="20" />
                <Button Text="Show me healthy snack options"
                        Clicked="OnSuggestedQuestionClicked"
                        BackgroundColor="#EEEEEE" TextColor="#000" CornerRadius="20" />
            </HorizontalStackLayout>
        </ScrollView>

        <!-- Input bar -->
        <Grid Grid.Row="3" Padding="12" BackgroundColor="White">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="50" />
            </Grid.ColumnDefinitions>

            <Entry x:Name="UserInput"
                   Placeholder="Ask me anything..."
                   HeightRequest="44"
                   BackgroundColor="#F0F0F0"
                   TextColor="#000"
                   Margin="0,0,8,0" />

            <ImageButton Source="send_icon.png"
                         BackgroundColor="#D32F2F"
                         Grid.Column="1"
                         HeightRequest="44"
                         WidthRequest="44"
                         CornerRadius="22"
                         Clicked="OnSendMessage" />
        </Grid>
    </Grid>
</ContentPage>
